{"version":3,"sources":["webpack:///webpack/bootstrap 65fba0218c1aa0f74ba3","webpack:///./src/dev/injectScript.js"],"names":["msgType","nodeInfo","nodeListInfo","notSupport","postData","scene","name","children","window","inspectorGameMemoryStorage","getNodeComponentsInfo","node","ret","nodeComp","_components","i","length","itemComp","uuid","push","type","constructor","pluginSetNodeActive","isActive","active","getNodeInfo","nodeData","x","y","zIndex","childrenCount","width","height","color","toCSS","opacity","rotation","rotationX","rotationY","anchorX","anchorY","scaleX","scaleY","skewX","skewY","components","nodeType","sendMsgToDevTools","console","log","getNodeChildren","data","nodeChildren","getChildren","childItem","msg","postMessage","isCocosCreatorGame","cocosInspectorTestVar","cc","e","director","getScene","sceneChildren"],"mappings":"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","file":"injectScript.main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 151);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 65fba0218c1aa0f74ba3","// eval 注入脚本的代码,变量尽量使用var,后来发现在import之后,let会自动变为var\nexport default function () {\n  let msgType = {\n    nodeInfo: 2,//节点信息\n    nodeListInfo: 1,// 节点列表信息\n    notSupport: 0,// 不支持的游戏\n  };\n  let postData = {\n    scene: {\n      name: \"\",\n      children: []\n    },\n  };\n  window.inspectorGameMemoryStorage = window.inspectorGameMemoryStorage || {};\n\n  // 收集组件信息\n  function getNodeComponentsInfo(node) {\n    let ret = [];\n    let nodeComp = node._components;\n    for (let i = 0; i < nodeComp.length; i++) {\n      let itemComp = nodeComp[i];\n      window.inspectorGameMemoryStorage[itemComp.uuid] = itemComp;\n      ret.push({\n        uuid: itemComp.uuid,\n        type: itemComp.constructor.name,\n        name: itemComp.name,\n      });\n    }\n    return ret;\n  }\n\n  // 设置节点是否可视\n  window.pluginSetNodeActive = function (uuid, isActive) {\n    let node = window.inspectorGameMemoryStorage[uuid];\n    if (node) {\n      if (isActive === 1) {\n        node.active = true;\n      } else if (isActive === 0) {\n        node.active = false;\n      }\n    }\n  };\n  // 获取节点信息\n  window.getNodeInfo = function (uuid) {\n    let node = window.inspectorGameMemoryStorage[uuid];\n    if (node) {\n      let nodeComp = getNodeComponentsInfo(node);\n      let nodeData = {\n        type: node.constructor.name,\n        uuid: node.uuid,\n        name: node.name,\n        x: node.x,\n        y: node.y,\n        zIndex: node.zIndex,\n        childrenCount: node.childrenCount,\n        children: [],\n        width: node.width,\n        height: node.height,\n        color: node.color.toCSS(),\n        opacity: node.opacity,\n        rotation: node.rotation,\n        rotationX: node.rotationX,\n        rotationY: node.rotationY,\n        anchorX: node.anchorX,\n        anchorY: node.anchorY,\n        scaleX: node.scaleX,\n        scaleY: node.scaleY,\n        skewX: node.skewX,\n        skewY: node.skewY,\n        components: nodeComp\n      };\n      let nodeType = node.constructor.name;\n      if (nodeType === 'cc_Scene') {\n\n      } else {\n        nodeData.active = node.active;\n      }\n      window.sendMsgToDevTools(msgType.nodeInfo, nodeData);\n    } else {\n      // 未获取到节点数据\n      console.log(\"未获取到节点数据\");\n    }\n  };\n\n  // 收集节点信息\n  function getNodeChildren(node, data) {\n    // console.log(\"nodeName: \" + node.name);\n    let nodeData = {\n      uuid: node.uuid,\n      name: node.name,\n      children: [],\n    };\n    window.inspectorGameMemoryStorage[node.uuid] = node;\n    let nodeChildren = node.getChildren();\n    for (let i = 0; i < nodeChildren.length; i++) {\n      let childItem = nodeChildren[i];\n      // console.log(\"childName: \" + childItem.name);\n      getNodeChildren(childItem, nodeData.children);\n    }\n    data.push(nodeData);\n  }\n\n  window.sendMsgToDevTools = function (type, msg) {\n    window.postMessage({type: type, msg: msg}, \"*\");\n  };\n  // 检测是否包含cc变量\n  let isCocosCreatorGame = true;\n  try {\n    let cocosInspectorTestVar = cc;\n  } catch (e) {\n    isCocosCreatorGame = false;\n    window.sendMsgToDevTools(msgType.notSupport, \"不支持调试游戏!\");\n  }\n\n  if (isCocosCreatorGame) {\n    let scene = cc.director.getScene();\n    if (scene) {\n      postData.scene = {\n        type: 1,// 标识类型\n        uuid: scene.uuid,\n        name: scene.name,\n        children: [],\n      };\n      window.inspectorGameMemoryStorage[scene.uuid] = scene;\n\n      let sceneChildren = scene.getChildren();\n      for (let i = 0; i < sceneChildren.length; i++) {\n        let node = sceneChildren[i];\n        getNodeChildren(node, postData.scene.children);\n      }\n      // console.log(postData);\n      window.sendMsgToDevTools(msgType.nodeListInfo, postData);\n    } else {\n      postData.scene = null;\n      window.sendMsgToDevTools(msgType.notSupport, \"不支持调试游戏!\");\n    }\n  } else {\n    console.log(\"未发现cocos creator game\");\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dev/injectScript.js"],"sourceRoot":""}